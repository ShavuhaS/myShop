import{Server}from"../js/pages/main/classes.js";import{previewProductBlock}from"../js/modules/productModule.js";const server=new Server,toggleButtons=document.querySelectorAll(".header__action-menu");toggleButtons.forEach((e=>{e.addEventListener("click",(()=>{const e=document.querySelector(".header__menu-wrapper");e&&e.classList.toggle("hidden")}))}));const cartButtons=document.querySelectorAll(".header__action-cart");cartButtons.forEach((e=>{e.addEventListener("click",(e=>{const t=document.querySelector(".header__cart-wrapper"),r=localStorage.getItem("cart");if(t){if(r){t.classList.remove("empty");const e=t.querySelector(".header__cart");e&&(e.textContent="");const c=document.querySelector(".header__cart-price"),a=document.querySelector(".header__cart-amount");let o=0;JSON.parse(r).forEach((t=>{o+=t.price,null==e||e.append(previewProductBlock(t))})),c&&(c.textContent=`${o} $`),a&&(a.textContent=JSON.parse(r).length)}else t.classList.add("empty"),t.textContent="Корзина пустая";t.classList.toggle("hidden")}}))}));const searchInput=document.querySelector(".header__search");searchInput&&searchInput.addEventListener("change",(e=>{const t=document.querySelector(".header__search-dropdown"),r=e.target;t&&(t.innerHTML="",""!==r.value?(t.classList.remove("hidden"),searchInput.classList.add("active"),server.request(`products?q=${r.value}`).then((e=>{console.log(e),e.forEach((e=>{t.append(previewProductBlock(e))}))}))):(t.classList.add("hidden"),searchInput.classList.remove("active")))}));const updateCart=()=>{const e=localStorage.getItem("cart");if(e){document.querySelectorAll(".header__action-cart-wrapper").forEach((t=>{const r=t.querySelector(".header__action-cart-itemCount");t.querySelector(".header__action-cart");let c=JSON.parse(e).length;0===c?r.classList.add("hidden"):(r.classList.remove("hidden"),r.textContent=c)}))}};window.addEventListener("load",updateCart);

